# 基于动态分区的电网并行恢复策略及其模拟应用

## 1. 项目简介

本项目为课程期末大作业代码库，基于混合整数线性规划（MILP）和滚动时域优化（SHMPC）框架，实现了考虑启动功率冲击和网络连通性的电力系统并行恢复策略。

代码包含对 IEEE 39、IEEE 118 标准系统的基准测试，以及针对 **2025年西班牙大停电** 场景的灾难演化与动态分区恢复模拟。

## 2. 运行环境要求

为了确保程序正常运行，请确保 MATLAB 环境已安装以下工具箱和求解器：

* **MATLAB** (推荐版本 R2023b 或更高)
* **MATPOWER** (用于加载标准电网数据 `loadcase`)
* **YALMIP** (建模语言工具箱)
* **Gurobi Optimizer** (底层 MILP 求解器)

## 3. 文件清单与功能说明

本项目共包含 6 个主要 MATLAB 文件，分为**核心求解层**、**数据初始化层**和**场景执行层**：

### A. 核心求解层

* **`solve_master_problem.m`**
* **功能**：核心优化函数。基于 YALMIP 构建 MILP 数学模型。
* **细节**：包含机组启动时序约束、基于虚拟流（Virtual Flow）的连通性约束、启动功率冲击约束以及灵活性资源供需平衡约束。

### B. 数据初始化层

* **`init_system_data.m`**
* **功能**：标准算例初始化。
* **细节**：读取 IEEE 39/118 原始数据，补充机组爬坡率、启动延迟、风电预测曲线及储能参数。

* **`init_spain_like_118.m`**
* **功能**：西班牙场景专用初始化。
* **细节**：对 IEEE 118 系统进行拓扑改造，划分 Zone A (西班牙) 和 Zone B (葡萄牙)，标记关键跨区联络线，用于模拟解列场景。

### C. 场景执行层 (Scenarios & Execution)

* **`Run_Rolling_Framework_case39.m`**
* **功能**：**[基准测试 1]** IEEE 39 节点系统仿真。
* **目标**：验证算法在小规模系统下的机组启动时序和阶梯式恢复特性。

* **`Run_Rolling_Framework_case118.m`**
* **功能**：**[基准测试 2]** IEEE 118 节点系统仿真。
* **目标**：验证算法在大规模系统下的机组启动时序和阶梯式恢复特性。

* **`Run_Real_Spain_Blackout.m`**
* **功能**：**[核心应用]** 西班牙大停电全过程复现。
* **目标**：模拟 T=10 电压振荡、T=11 连锁脱网、T=12 系统解列等灾难链。对比“静态分区”与“动态分区”策略的恢复效果。

## 4. 使用方法 (How to Run)

**步骤 1：基础功能验证**
直接运行 `Run_Rolling_Framework_case39.m`。

* **预期结果**：控制台输出 Step 1-20 的滚动日志，结束后自动绘制“系统总出力阶梯恢复曲线”和“机组并网堆叠图”。

**步骤 2：大规模系统验证**
运行 `Run_Rolling_Framework_case118.m`。

* **预期结果**：控制台输出 Step 1-40 的日志，展示多分区并行启动的 S 型增长曲线。

**步骤 3：西班牙大停电模拟**
运行 `Run_Real_Spain_Blackout.m`。

* **预期结果**：输出灾难演化过程中的决策日志，并对比两种策略下的负荷恢复率。
如有任何运行问题，请检查 Gurobi 求解器状态。
